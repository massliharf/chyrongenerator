function ht(p,u){for(var r=0;r<u.length;r++){const n=u[r];if(typeof n!="string"&&!Array.isArray(n)){for(const h in n)if(h!=="default"&&!(h in p)){const B=Object.getOwnPropertyDescriptor(n,h);B&&Object.defineProperty(p,h,B.get?B:{enumerable:!0,get:()=>n[h]})}}}return Object.freeze(Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}))}function ct(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var _={exports:{}},Q;function wt(){return Q||(Q=1,(function(p){(function(){function u(t,i){let e={};return[t,i].forEach(function(o){for(let l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}),e}function r(t){if(typeof t!="string"||!t.match(/^data:image\/webp;base64,/i))throw new Error("Failed to decode WebP Base64 URL");return window.atob(t.substring(23))}function n(t,i){let e=typeof t=="string"&&/^data:image\/webp/.test(t)?t:t.toDataURL("image/webp",i);return r(e)}function h(t){let i=t.charCodeAt(0),e=t.charCodeAt(1),o=t.charCodeAt(2),l=t.charCodeAt(3);return(i|e<<8|o<<16|l<<24)>>>0}function B(t){let i=t.indexOf("VP8",12);if(i===-1)throw new Error("Bad image format, does this browser support WebP?");let e=!1;for(;i<t.length-8;){let o,l;switch(l=t.substring(i,i+4),i+=4,o=h(t.substring(i,i+4)),i+=4,l){case"VP8 ":return{frame:t.substring(i,i+o),hasAlpha:e};case"ALPH":e=!0;break}i+=o,(o&1)!==0&&i++}throw new Error("Failed to find VP8 keyframe in WebP image, is this image mistakenly encoded in the Lossless WebP format?")}const A=-1,m=-2;function F(t){this.value=t}function L(t){this.value=t}function U(t,i,e){if(Array.isArray(e))for(let o=0;o<e.length;o++)U(t,i,e[o]);else if(typeof e=="string")t.writeString(e);else if(e instanceof Uint8Array)t.writeBytes(e);else if(e.id)if(e.offset=t.pos+i,t.writeUnsignedIntBE(e.id),Array.isArray(e.data)){let o,l,g;e.size===A?t.writeByte(255):e.size===m?(o=t.pos,t.writeBytes([15,255,255,255,255])):(o=t.pos,t.writeBytes([0,0,0,0])),l=t.pos,e.dataOffset=l+i,U(t,i,e.data),e.size!==A&&e.size!==m&&(g=t.pos,e.size=g-l,t.seek(o),t.writeEBMLVarIntWidth(e.size,4),t.seek(g))}else if(typeof e.data=="string")t.writeEBMLVarInt(e.data.length),e.dataOffset=t.pos+i,t.writeString(e.data);else if(typeof e.data=="number")e.size||(e.size=t.measureUnsignedInt(e.data)),t.writeEBMLVarInt(e.size),e.dataOffset=t.pos+i,t.writeUnsignedIntBE(e.data,e.size);else if(e.data instanceof L)t.writeEBMLVarInt(8),e.dataOffset=t.pos+i,t.writeDoubleBE(e.data.value);else if(e.data instanceof F)t.writeEBMLVarInt(4),e.dataOffset=t.pos+i,t.writeFloatBE(e.data.value);else if(e.data instanceof Uint8Array)t.writeEBMLVarInt(e.data.byteLength),e.dataOffset=t.pos+i,t.writeBytes(e.data);else throw new Error("Bad EBML datatype "+typeof e.data);else throw new Error("Bad EBML datatype "+typeof e.data)}let f=function(t,i){return function(e){let o=5e3,l=1,g=!1,C=0,P=0,x=null,W=null,M=null,E=[],S=0,b=0,Y={quality:.95,transparent:!1,alphaQuality:void 0,fileWriter:null,fd:null,frameDuration:null,frameRate:null},N={Cues:{id:new Uint8Array([28,83,187,107]),positionEBML:null},SegmentInfo:{id:new Uint8Array([21,73,169,102]),positionEBML:null},Tracks:{id:new Uint8Array([22,84,174,107]),positionEBML:null}},k,j={id:17545,data:new L(0)},I,z=[],c=new i(e.fileWriter||e.fd);function V(a){return a-k.dataOffset}function J(a){(x===null||x.width!==a.width||x.height!==a.height)&&(x=document.createElement("canvas"),x.width=a.width,x.height=a.height,W=x.getContext("2d"),M=W.createImageData(x.width,x.height));let s=a.getContext("2d"),w=s.getImageData(0,0,a.width,a.height).data,d=M.data,y=0,D=a.width*a.height*4;for(let O=3;O<D;O+=4){let T=w[O];d[y++]=T,d[y++]=T,d[y++]=T,d[y++]=255}return W.putImageData(M,0,0),x}function tt(){let a={id:21420,size:5,data:0},s={id:290298740,data:[]};for(let w in N){let d=N[w];d.positionEBML=Object.create(a),s.data.push({id:19899,data:[{id:21419,data:d.id},d.positionEBML]})}return s}function H(){I=tt();let a={id:440786851,data:[{id:17030,data:1},{id:17143,data:1},{id:17138,data:4},{id:17139,data:8},{id:17026,data:"webm"},{id:17031,data:2},{id:17029,data:2}]},s={id:357149030,data:[{id:2807729,data:1e6},{id:19840,data:"webm-writer-js"},{id:22337,data:"webm-writer-js"},j]},w=[{id:176,data:C},{id:186,data:P}];e.transparent&&w.push({id:21440,data:1});let d={id:374648427,data:[{id:174,data:[{id:215,data:l},{id:29637,data:l},{id:156,data:0},{id:2274716,data:"und"},{id:134,data:"V_VP8"},{id:2459272,data:"VP8"},{id:131,data:1},{id:224,data:w}]}]};k={id:408125543,size:m,data:[I,s,d]};let y=new t(256);U(y,c.pos,[a,k]),c.write(y.getAsDataArray()),N.SegmentInfo.positionEBML.data=V(s.offset),N.Tracks.positionEBML.data=V(d.offset),g=!0}function et(a){let s,w,d=new t(4);if(!(a.trackNumber>0&&a.trackNumber<127))throw new Error("TrackNumber must be > 0 and < 127");return d.writeEBMLVarInt(a.trackNumber),d.writeU16BE(a.timecode),d.writeByte(0),s={id:161,data:[d.getAsDataArray(),a.frame]},w={id:30113,data:[{id:166,data:[{id:238,data:1},{id:165,data:a.alpha}]}]},{id:160,data:[s,w]}}function rt(a){let s=new t(4);if(!(a.trackNumber>0&&a.trackNumber<127))throw new Error("TrackNumber must be > 0 and < 127");return s.writeEBMLVarInt(a.trackNumber),s.writeU16BE(a.timecode),s.writeByte(128),{id:163,data:[s.getAsDataArray(),a.frame]}}function at(a){return a.alpha?et(a):rt(a)}function it(a){return{id:524531317,data:[{id:231,data:Math.round(a.timecode)}]}}function nt(a,s,w){z.push({id:187,data:[{id:179,data:s},{id:183,data:[{id:247,data:a},{id:241,data:V(w)}]}]})}function ot(){let a={id:475249515,data:z},s=new t(16+z.length*32);U(s,c.pos,a),c.write(s.getAsDataArray()),N.Cues.positionEBML.data=V(a.offset)}function K(){if(E.length===0)return;let a=0;for(let d=0;d<E.length;d++)a+=E[d].frame.length+(E[d].alpha?E[d].alpha.length:0);let s=new t(a+E.length*64),w=it({timecode:Math.round(S)});for(let d=0;d<E.length;d++)w.data.push(at(E[d]));U(s,c.pos,w),c.write(s.getAsDataArray()),nt(l,Math.round(S),w.offset),E=[],S+=b,b=0}function st(){if(!e.frameDuration)if(e.frameRate)e.frameDuration=1e3/e.frameRate;else throw new Error("Missing required frameDuration or frameRate setting");e.quality=Math.max(Math.min(e.quality,.99999),0),e.alphaQuality===void 0?e.alphaQuality=e.quality:e.alphaQuality=Math.max(Math.min(e.alphaQuality,.99999),0)}function dt(a){a.trackNumber=l,a.timecode=Math.round(b),E.push(a),b+=a.duration,b>=o&&K()}function ft(){let a=new t(I.size),s=c.pos;U(a,I.dataOffset,I.data),c.seek(I.dataOffset),c.write(a.getAsDataArray()),c.seek(s)}function ut(){let a=new t(8),s=c.pos;a.writeDoubleBE(S),c.seek(j.dataOffset),c.write(a.getAsDataArray()),c.seek(s)}function lt(){let a=new t(10),s=c.pos;a.writeUnsignedIntBE(k.id),a.writeEBMLVarIntWidth(c.pos-k.dataOffset,5),c.seek(k.offset),c.write(a.getAsDataArray()),c.seek(s)}this.addFrame=function(a,s,w){g||(C=a.width||0,P=a.height||0,H());let d=B(n(a,e.quality)),y,D=null;w?y=w:typeof s=="number"?y=s:y=e.frameDuration,e.transparent&&(s instanceof HTMLCanvasElement||typeof s=="string"?D=s:d.hasAlpha&&(D=J(a))),dt({frame:d.frame,duration:y,alpha:D?B(n(D,e.alphaQuality)).frame:null})},this.complete=function(){return g||H(),K(),ot(),ft(),ut(),lt(),c.complete("video/webm")},this.getWrittenSize=function(){return c.length},e=u(Y,e||{}),st()}};p.exports=f})()})(_)),_.exports}var R={exports:{}},G;function pt(){return G||(G=1,(function(p){(function(){let u=function(r){this.data=new Uint8Array(r),this.pos=0};u.prototype.seek=function(r){this.pos=r},u.prototype.writeBytes=function(r){for(let n=0;n<r.length;n++)this.data[this.pos++]=r[n]},u.prototype.writeByte=function(r){this.data[this.pos++]=r},u.prototype.writeU8=u.prototype.writeByte,u.prototype.writeU16BE=function(r){this.data[this.pos++]=r>>8,this.data[this.pos++]=r},u.prototype.writeDoubleBE=function(r){let n=new Uint8Array(new Float64Array([r]).buffer);for(let h=n.length-1;h>=0;h--)this.writeByte(n[h])},u.prototype.writeFloatBE=function(r){let n=new Uint8Array(new Float32Array([r]).buffer);for(let h=n.length-1;h>=0;h--)this.writeByte(n[h])},u.prototype.writeString=function(r){for(let n=0;n<r.length;n++)this.data[this.pos++]=r.charCodeAt(n)},u.prototype.writeEBMLVarIntWidth=function(r,n){switch(n){case 1:this.writeU8(128|r);break;case 2:this.writeU8(64|r>>8),this.writeU8(r);break;case 3:this.writeU8(32|r>>16),this.writeU8(r>>8),this.writeU8(r);break;case 4:this.writeU8(16|r>>24),this.writeU8(r>>16),this.writeU8(r>>8),this.writeU8(r);break;case 5:this.writeU8(8|r/4294967296&7),this.writeU8(r>>24),this.writeU8(r>>16),this.writeU8(r>>8),this.writeU8(r);break;default:throw new Error("Bad EBML VINT size "+n)}},u.prototype.measureEBMLVarInt=function(r){if(r<127)return 1;if(r<16383)return 2;if(r<(1<<21)-1)return 3;if(r<(1<<28)-1)return 4;if(r<34359738367)return 5;throw new Error("EBML VINT size not supported "+r)},u.prototype.writeEBMLVarInt=function(r){this.writeEBMLVarIntWidth(r,this.measureEBMLVarInt(r))},u.prototype.writeUnsignedIntBE=function(r,n){switch(n===void 0&&(n=this.measureUnsignedInt(r)),n){case 5:this.writeU8(Math.floor(r/4294967296));case 4:this.writeU8(r>>24);case 3:this.writeU8(r>>16);case 2:this.writeU8(r>>8);case 1:this.writeU8(r);break;default:throw new Error("Bad UINT size "+n)}},u.prototype.measureUnsignedInt=function(r){return r<256?1:r<65536?2:r<1<<24?3:r<4294967296?4:5},u.prototype.getAsDataArray=function(){if(this.pos<this.data.byteLength)return this.data.subarray(0,this.pos);if(this.pos==this.data.byteLength)return this.data;throw new Error("ArrayBufferDataStream's pos lies beyond end of buffer")},p.exports=u})()})(R)),R.exports}var q={exports:{}},Z;function Bt(){return Z||(Z=1,(function(p){(function(){let u=function(r){return function(n){let h=[],B=Promise.resolve(),A=null,m=null;n&&n.constructor.name==="FileWriter"?A=n:r&&n&&(m=n),this.pos=0,this.length=0;function F(f){return new Promise(function(t,i){let e=new FileReader;e.addEventListener("loadend",function(){t(e.result)}),e.readAsArrayBuffer(f)})}function L(f){return new Promise(function(t,i){f instanceof Uint8Array?t(f):f instanceof ArrayBuffer||ArrayBuffer.isView(f)?t(new Uint8Array(f)):f instanceof Blob?t(F(f).then(function(e){return new Uint8Array(e)})):t(F(new Blob([f])).then(function(e){return new Uint8Array(e)}))})}function U(f){let t=f.byteLength||f.length||f.size;if(!Number.isInteger(t))throw new Error("Failed to determine size of element");return t}this.seek=function(f){if(f<0)throw new Error("Offset may not be negative");if(isNaN(f))throw new Error("Offset may not be NaN");if(f>this.length)throw new Error("Seeking beyond the end of file is not allowed");this.pos=f},this.write=function(f){let t={offset:this.pos,data:f,length:U(f)},i=t.offset>=this.length;this.pos+=t.length,this.length=Math.max(this.length,this.pos),B=B.then(function(){if(m)return new Promise(function(e,o){L(t.data).then(function(l){let g=0,C=Buffer.from(l.buffer),P=function(x,W,M){g+=W,g>=M.length?e():r.write(m,M,g,M.length-g,t.offset+g,P)};r.write(m,C,0,C.length,t.offset,P)})});if(A)return new Promise(function(e,o){A.onwriteend=e,A.seek(t.offset),A.write(new Blob([t.data]))});if(!i)for(let e=0;e<h.length;e++){let o=h[e];if(!(t.offset+t.length<=o.offset||t.offset>=o.offset+o.length)){if(t.offset<o.offset||t.offset+t.length>o.offset+o.length)throw new Error("Overwrite crosses blob boundaries");if(t.offset==o.offset&&t.length==o.length){o.data=t.data;return}else return L(o.data).then(function(l){return o.data=l,L(t.data)}).then(function(l){t.data=l,o.data.set(t.data,t.offset-o.offset)})}}h.push(t)})},this.complete=function(f){return m||A?B=B.then(function(){return null}):B=B.then(function(){let t=[];for(let i=0;i<h.length;i++)t.push(h[i].data);return new Blob(t,{type:f})}),B}}};p.exports=u})()})(q)),q.exports}var v,$;function gt(){return $||($=1,v=wt()(pt(),Bt()(null))),v}var X=gt();const yt=ct(X),xt=ht({__proto__:null,default:yt},[X]);export{xt as b};
